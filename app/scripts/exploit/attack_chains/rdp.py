def evaluate_rdp(facts):
    """
    facts = {
        "service": "RDP" ou "Remote Desktop",
        "version": "10.0.17763",
        "validated_cves": [...],
        "headers": [...],
    }
    """

    service = (facts.get("service") or "").lower()
    version = facts.get("version") or ""
    cves = set(facts.get("validated_cves", []))
    headers = " ".join(facts.get("headers", [])).lower()

    # Vérifier si c'est un service RDP
    rdp_services = ["rdp", "remote desktop", "terminal services"]
    if not any(rdp_svc in service for rdp_svc in rdp_services):
        return None

    # ===============================
    # 1️⃣ BlueKeep (CVE-2019-0708) - RDP RCE
    # ===============================
    if "CVE-2019-0708" in cves:
        return {
            "attack": "BlueKeep (CVE-2019-0708) RDP RCE",
            "confidence": 0.95,
            "exploit": "exploit/rdp/bluekeep_cve_2019_0708"
        }

    # ===============================
    # 2️⃣ DejaBlue (CVE-2019-1181, CVE-2019-1182)
    # ===============================
    if "CVE-2019-1181" in cves or "CVE-2019-1182" in cves:
        return {
            "attack": "DejaBlue RDP RCE vulnerabilities",
            "confidence": 0.90,
            "exploit": "exploit/rdp/dejablue_rdp_rce"
        }

    # ===============================
    # 3️⃣ PrintNightmare via RDP (CVE-2021-34527)
    # ===============================
    if "CVE-2021-34527" in cves:
        return {
            "attack": "PrintNightmare (CVE-2021-34527) via RDP",
            "confidence": 0.85,
            "exploit": "exploit/rdp/printnightmare_cve_2021_34527"
        }

    # ===============================
    # 4️⃣ OpenSSL RDP (CVE-2021-38647)
    # ===============================
    if "CVE-2021-38647" in cves:
        return {
            "attack": "OpenSSL RDP vulnerability (CVE-2021-38647)",
            "confidence": 0.80,
            "exploit": None
        }

    # ===============================
    # 5️⃣ RDP Man-in-the-Middle (CVE-2020-0610)
    # ===============================
    if "CVE-2020-0610" in cves:
        return {
            "attack": "RDP Man-in-the-Middle vulnerability",
            "confidence": 0.75,
            "exploit": None
        }

    # ===============================
    # 6️⃣ RDP Brute Force / Credential Stuffing
    # ===============================
    if any(cve.startswith("CVE-") for cve in cves):
        return {
            "attack": "RDP brute force / credential stuffing",
            "confidence": 0.60,
            "exploit": None
        }

    return None