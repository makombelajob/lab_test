def evaluate_mysql(facts):
    """
    facts = {
        "service": "MySQL",
        "version": "5.7.34",
        "validated_cves": [...],
        "headers": [...],
    }
    """

    service = (facts.get("service") or "").lower()
    version = facts.get("version") or ""
    cves = set(facts.get("validated_cves", []))
    headers = " ".join(facts.get("headers", [])).lower()

    if "mysql" not in service:
        return None

    # ===============================
    # 1️⃣ MySQL UDF RCE / Privilege Escalation
    # ===============================
    if any(
        cve in cves for cve in {
            "CVE-2016-6663",
            "CVE-2016-6662",
            "CVE-2016-6664"
        }
    ):
        return {
            "attack": "MySQL UDF privilege escalation → RCE",
            "confidence": 0.90,
            "exploit": "exploit/mysql/mysql_yassl_hello"
        }

    # ===============================
    # 2️⃣ MySQL Remote Code Execution (CVE-2020-14882 style)
    # ===============================
    if version.startswith("5.") and any(
        cve.startswith("CVE-2020") or cve.startswith("CVE-2021") for cve in cves
    ):
        return {
            "attack": "MySQL remote code execution (version-specific)",
            "confidence": 0.80,
            "exploit": None
        }

    # ===============================
    # 3️⃣ MySQL SQL Injection / Auth Bypass
    # ===============================
    if any(
        cve in cves for cve in {
            "CVE-2012-2122",
            "CVE-2016-5734"
        }
    ):
        return {
            "attack": "MySQL authentication bypass / SQL injection",
            "confidence": 0.85,
            "exploit": "exploit/mysql/mysql_authbypass_hashdump"
        }

    # ===============================
    # 4️⃣ MySQL Version-based exploits
    # ===============================
    if version.startswith("8.") and any(cve.startswith("CVE-2022") for cve in cves):
        return {
            "attack": "MySQL 8.x remote code execution / privilege escalation",
            "confidence": 0.75,
            "exploit": None
        }

    if version.startswith("5.7.") and any(cve.startswith("CVE-") for cve in cves):
        return {
            "attack": "MySQL 5.7.x vulnerabilities (RCE candidates)",
            "confidence": 0.70,
            "exploit": None
        }

    if version.startswith("5.6.") or version.startswith("5.5."):
        return {
            "attack": "MySQL legacy version (potential vulnerabilities)",
            "confidence": 0.60,
            "exploit": None
        }

    # ===============================
    # 5️⃣ MySQL Brute Force / Weak Credentials
    # ===============================
    if any(cve.startswith("CVE-") for cve in cves):
        return {
            "attack": "MySQL brute force / weak authentication",
            "confidence": 0.50,
            "exploit": None
        }

    return None