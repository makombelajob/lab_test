class ExploitMapper:
    """
    CVE + service + version → Metasploit module
    """

    def map(self, cve, service, version):
        s = (service or "").lower()
        v = (version or "")

        # Apache 2.4.49–2.4.52 RCE
        if cve in (
            "CVE-2022-22720",
            "CVE-2022-22721",
            "CVE-2022-23943",
            "CVE-2022-22719",
        ) and "apache" in s:
            return {
                "module": "exploit/multi/http/apache_normalize_path_rce",
                "payload": "linux/x64/meterpreter/reverse_tcp",
                "rport": 8082,
                "confidence": 0.93
            }

        return None
