from scripts.exploit.exploit_mapper import ExploitMapper

class ExploitEngine:

    def __init__(self):
        self.mapper = ExploitMapper()

    def analyze(self, target, service, version, cve):
        rec = self.mapper.map(cve, service, version)

        if not rec:
            return {
                "status": False,
                "impact": "no_exploit",
                "proof": "No exploit mapped"
            }

        return {
            "status": True,
            "impact": "rce_possible",
            "proof": f"Mapped to {rec['module']}",
            "recommended_exploit": rec
        }
