# scripts/exploit/engine/exploit_runner.py

class ExploitRunner:
    """
    Lanceur d’exploit réel
    Reçoit le chemin logique depuis l’attack chain
    """

    def run(self, exploit, target):
        """
        exploit : string ex. "exploit/multi/http/apache_php_rce"
        target  : IP ou hostname
        """

        # ==============================
        # AJOUT : gestion Apache + PHP
        # ==============================
        if exploit == "exploit/multi/http/apache_php_rce":
            try:
                # Import LOCAL du module d’exploit
                from scripts.exploit.multi.http.apache_php_rce import ApachePHPRCE

                engine = ApachePHPRCE()
                return engine.run(target)

            except Exception as e:
                return {
                    "status": False,
                    "proof": f"Exploit execution error: {str(e)}"
                }

        # ==============================
        # Exploit inconnu
        # ==============================
        return {
            "status": False,
            "proof": "Exploit not implemented"
        }
