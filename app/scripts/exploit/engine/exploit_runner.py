# scripts/exploit/engine/exploit_runner.py
import importlib
class ExploitRunner:
    """
    Lanceur d’exploit réel
    Reçoit le chemin logique depuis l’attack chain
    """

    def run(self, exploit_path, target):
        """
        exploit : string ex. "exploit/multi/http/apache_php_rce"
        target  : IP ou hostname
        """
        try:
            parts = exploit_path.split("/")
            module_name = parts[-1]
            service = parts[-2]
            
            module_path = f"scripts.exploit.modules.{service}.{module_name}"
            module = importlib.import_module(module_path)
            return module.run(target)
        except Exception as e:
            return {
                "status": False,
                "proof": f"Exploit runner error: {str(e)}"
            }
            