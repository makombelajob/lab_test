class ExploitMapper:
    """
    Transforme (CVE + service + version) en intention d’attaque.
    Ne lance rien. Ne contient pas de payloads.
    """

    def map(self, cve, service, version):
        s = (service or "").lower()
        v = (version or "")

        # Famille Apache path normalization
        if cve in (
            "CVE-2022-22720",
            "CVE-2022-22721",
            "CVE-2022-23943",
            "CVE-2022-22719",
        ) and "apache" in s:
            return {
                "attack_family": "apache_path_traversal_rce",
                "service": "Apache",
                "version": v,
                "confidence": 0.93,
                "risk": "CRITICAL"
            }

        # Ton CVE 2025 info‑leak
        if cve == "CVE-2025-58098" and "apache" in s:
            return {
                "attack_family": "apache_version_disclosure",
                "service": "Apache",
                "version": v,
                "confidence": 0.40,
                "risk": "LOW"
            }

        return None
